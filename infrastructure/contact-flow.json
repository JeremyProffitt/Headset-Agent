{
  "Version": "2019-10-30",
  "StartAction": "setVoice",
  "Metadata": {
    "entryPointPosition": {"x": 40, "y": 40},
    "ActionMetadata": {
      "setVoice": {"position": {"x": 150, "y": 40}},
      "lexBot": {"position": {"x": 350, "y": 40}},
      "goodbye": {"position": {"x": 950, "y": 40}},
      "retry1": {"position": {"x": 350, "y": 150}},
      "lexBot2": {"position": {"x": 550, "y": 150}},
      "retry2": {"position": {"x": 550, "y": 250}},
      "lexBot3": {"position": {"x": 750, "y": 250}},
      "finalError": {"position": {"x": 750, "y": 350}}
    }
  },
  "Actions": [
    {
      "Identifier": "setVoice",
      "Type": "UpdateContactTextToSpeechVoice",
      "Parameters": {
        "TextToSpeechVoice": "Joanna",
        "TextToSpeechEngine": "Neural"
      },
      "Transitions": {
        "NextAction": "lexBot",
        "Errors": [{"NextAction": "lexBot", "ErrorType": "NoMatchingError"}],
        "Conditions": []
      }
    },
    {
      "Identifier": "lexBot",
      "Type": "ConnectParticipantWithLexBot",
      "Parameters": {
        "Text": "Welcome to headset support. How can I help you today?",
        "LexV2Bot": {
          "AliasArn": "${LEX_BOT_ALIAS_ARN}"
        },
        "LexTimeoutSeconds": {
          "Text": "120"
        }
      },
      "Transitions": {
        "NextAction": "goodbye",
        "Errors": [
          {"NextAction": "retry1", "ErrorType": "NoMatchingError"},
          {"NextAction": "retry1", "ErrorType": "InputTimeLimitExceeded"},
          {"NextAction": "retry1", "ErrorType": "NoMatchingCondition"}
        ],
        "Conditions": []
      }
    },
    {
      "Identifier": "retry1",
      "Type": "MessageParticipant",
      "Parameters": {
        "Text": "I didn't quite catch that. Please describe your headset issue."
      },
      "Transitions": {
        "NextAction": "lexBot2",
        "Errors": [],
        "Conditions": []
      }
    },
    {
      "Identifier": "lexBot2",
      "Type": "ConnectParticipantWithLexBot",
      "Parameters": {
        "LexV2Bot": {
          "AliasArn": "${LEX_BOT_ALIAS_ARN}"
        },
        "LexTimeoutSeconds": {
          "Text": "120"
        }
      },
      "Transitions": {
        "NextAction": "goodbye",
        "Errors": [
          {"NextAction": "retry2", "ErrorType": "NoMatchingError"},
          {"NextAction": "retry2", "ErrorType": "InputTimeLimitExceeded"},
          {"NextAction": "retry2", "ErrorType": "NoMatchingCondition"}
        ],
        "Conditions": []
      }
    },
    {
      "Identifier": "retry2",
      "Type": "MessageParticipant",
      "Parameters": {
        "Text": "Let me try one more time. What problem are you having?"
      },
      "Transitions": {
        "NextAction": "lexBot3",
        "Errors": [],
        "Conditions": []
      }
    },
    {
      "Identifier": "lexBot3",
      "Type": "ConnectParticipantWithLexBot",
      "Parameters": {
        "LexV2Bot": {
          "AliasArn": "${LEX_BOT_ALIAS_ARN}"
        },
        "LexTimeoutSeconds": {
          "Text": "120"
        }
      },
      "Transitions": {
        "NextAction": "goodbye",
        "Errors": [
          {"NextAction": "finalError", "ErrorType": "NoMatchingError"},
          {"NextAction": "finalError", "ErrorType": "InputTimeLimitExceeded"},
          {"NextAction": "finalError", "ErrorType": "NoMatchingCondition"}
        ],
        "Conditions": []
      }
    },
    {
      "Identifier": "finalError",
      "Type": "MessageParticipant",
      "Parameters": {
        "Text": "I apologize, but I'm having trouble understanding. Please call back later. Thank you."
      },
      "Transitions": {
        "NextAction": "goodbye",
        "Errors": [],
        "Conditions": []
      }
    },
    {
      "Identifier": "goodbye",
      "Type": "DisconnectParticipant",
      "Parameters": {},
      "Transitions": {}
    }
  ]
}
